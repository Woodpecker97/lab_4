# Лабораторная работа №4. Классификация
## М856 4 курс Курасевич Алексей Викторович

# Содержание:
* [Постановка задачи](#постановка-задачи)
* [Анализ данных, предобработка](#анализ-данных-предобработка)
* [Модель обучения и результат, оценка качества модели](#модель-обучения-и-результат-оценка-качества-модели)
* [Улучшения качества модели, рекомендации](#улучшения-качества-модели-рекомендации)

## Постановка задачи
В задании нам предстоит исследовать данные, построить графики и схемы, позволяющие получить
информацию и визуализировать данные, обучить модель классификации,
оценить качество модели. Оформить документацию на github.com (код, данные, отчет,
презентация).

Используем датасет по ссылке:

https://www.kaggle.com/datasets/rashikrahmanpritom/heart-attack-analysis-prediction-dataset


## Анализ данных, предобработка
Данный датасет имеет следующие данные о 303 пациентах:
  - `age` - возраст пациента  
  - `sex` - Пол пациента  
  - `cp` - Тип боли в груди: 
    - `0` = типичная стенокардия, 
    - `1` = атипичная стенокардия, 
    - `2` = неангинозная боль, 
    - `3` = бессимптомная
  - `trtbps` - Артериальное давление в покое (в мм рт.ст.)
  - `chol` - Холесторал в мг/дл, полученный с помощью датчика ИМТ
  - `fbs` - (уровень сахара в крови натощак > 120 мг/дл):
    -  `1` = верно, 
    -  `0` = неверно
  - `restecg` — результаты электрокардиографии в покое:
    -  `0` = норма, 
    -  `1` = норма ST-T, 
    -  `2` = гипертрофия левого желудочка
  - `thalachh` - Максимальная достигнутая частота сердечных сокращений
  - `oldpeak` - Предыдущий пик
  - `slp` - Наклон
  - `caa` - Количество крупных судов
  - `thall` - результат стресс-теста с таллием ~ (0,3)
  - `exng` - Стенокардия, вызванная физической нагрузкой:
    -  `1` = Да,
    -  `0` = Нет
  - `output` - целевая переменная, принимает 0 или 1 в зависимости от отсутствия предрасположенности (0) или наличия предрасположенности (1) к заболеваниям сердца.

Распределение `output`:
![](https://github.com/Woodpecker97/lab_4/blob/main/data/output.png)


Данные не имеют пропусков, пациенты характеризуются категориальными и дискретными переменными:
- cat_list = ['sex','exng', 'caa', 'cp', 'fbs', 'restecg', 'slp', 'thall'] 
- con_list = ['age', 'trtbps', 'chol', 'thalachh', 'oldpeak'] 

Для перехода от категориальных переменных к бинарным была применена функция `get_dummies`.

Корреляционная матрица:
![](https://github.com/Woodpecker97/lab_4/blob/main/data/corr.png)

Countplot для категориальных переменных:
![](https://github.com/Woodpecker97/lab_4/blob/main/data/cat.png)

Для непрерывных переменных:


![](https://github.com/Woodpecker97/lab_4/blob/main/data/age.png)
![](https://github.com/Woodpecker97/lab_4/blob/main/data/chol.png)
![](https://github.com/Woodpecker97/lab_4/blob/main/data/oldpeak.png)
![](https://github.com/Woodpecker97/lab_4/blob/main/data/thalachh.png)
![](https://github.com/Woodpecker97/lab_4/blob/main/data/trtbps.png)

Видно сильное увеличение предрасположенности в районе 60 лет. Люди с большим значением thalachh (максимальный сердечный ритм) также более предрасположены.

## Модель обучения и результат, оценка качества модели

Выборка разделена на обучающую и тестовую в соотношении 3 к 1, то есть 227 пациентов в обучающей и 76 в тестовой.

Для линейных методов матрицу объекты-признаки необходимо предварительно масштабировать (то есть привести каждый признак к одному и тому же масштабу). Для этого в работе использовался StandardScaler.

Наилучший результат на тестовой выборке показали:
1. Линейная регрессия - 80,26%
2. GaussianNB - 80,26%
3. LinearSVC  - 80,26%

График значимости коэффициентов для линейной регрессии:

![](https://github.com/Woodpecker97/lab_4/blob/main/data/coeff.png)

## Улучшения качества модели, рекомендации

Модели получили достаточно высокую точность, но точность можно увеличить пополнив базу данных пациентов и обучив модель на большем объеме.
